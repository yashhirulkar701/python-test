---

trigger:
- master 

pool:
  name: Default
  demands:
    - agent.name -equals devops-agent

variables:
  name: Yash

jobs:
- job: 
  displayName: 'Run one-line script'
  steps:
  - script: |
      echo Hello, $(name)..!
      ls -l
      pwd

- job: Build
  displayName: 'Build and Push container Image'
  steps:
  - task: DockerInstaller@0
    inputs:
      dockerVersion: '20.10.21-0ubuntu1~20.04.2'

  - task: Docker@2
    inputs:
      containerRegistry: 'acrtestregistry12' #service connection name
      imageRepository: 'python-app'
      command: 'buildAndPush'
      Dockerfile: '**/Dockerfile'
      tags: '$(Build.BuildId)' 